{
  "entities": {
    "User": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "User",
      "type": "object",
      "description": "Represents a user of the CareerFlow.ai application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the User entity."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    },
    "LinkedInPost": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LinkedInPost",
      "type": "object",
      "description": "Represents a LinkedIn post generated by the AI.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the LinkedInPost entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N LinkedInPost)"
        },
        "content": {
          "type": "string",
          "description": "The text content of the LinkedIn post."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time the post was generated.",
          "format": "date-time"
        },
        "tone": {
          "type": "string",
          "description": "The tone of the LinkedIn Post. (e.g., professional, casual, hype)"
        },
        "projectDetails": {
          "type": "string",
          "description": "The user provided project details used to generate the post."
        }
      },
      "required": [
        "id",
        "userId",
        "content",
        "creationDate",
        "tone",
        "projectDetails"
      ]
    },
    "ResumeAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ResumeAnalysis",
      "type": "object",
      "description": "Represents the analysis of a resume against a job description.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the ResumeAnalysis entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N ResumeAnalysis)"
        },
        "resumeText": {
          "type": "string",
          "description": "The text content of the resume that was analyzed."
        },
        "jobDescriptionText": {
          "type": "string",
          "description": "The text content of the job description used for analysis."
        },
        "studentProjectPortfolioScore": {
          "type": "number",
          "description": "Score for student project portfolio vs JD tech stack"
        },
        "technicalKnowledgeScore": {
          "type": "number",
          "description": "Score for technical knowledge"
        },
        "keywordsScore": {
          "type": "number",
          "description": "Score based on keyword matching between resume and job description."
        },
        "analysisDate": {
          "type": "string",
          "description": "Date and time the analysis was performed.",
          "format": "date-time"
        },
        "suggestions": {
          "type": "string",
          "description": "Suggestions for improvement based on the analysis."
        }
      },
      "required": [
        "id",
        "userId",
        "resumeText",
        "jobDescriptionText",
        "studentProjectPortfolioScore",
        "technicalKnowledgeScore",
        "keywordsScore",
        "analysisDate",
        "suggestions"
      ]
    },
    "SkillGap": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SkillGap",
      "type": "object",
      "description": "Represents a skill gap analysis and learning roadmap.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the SkillGap entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N SkillGap)"
        },
        "targetRole": {
          "type": "string",
          "description": "The target role selected for skill gap analysis."
        },
        "jobDescription": {
          "type": "string",
          "description": "The job description used for skill gap analysis."
        },
        "learningRoadmap": {
          "type": "string",
          "description": "A JSON formatted string containing the learning roadmap with topics, resources, and GitHub links."
        },
        "analysisDate": {
          "type": "string",
          "description": "Date and time the analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "targetRole",
        "jobDescription",
        "learningRoadmap",
        "analysisDate"
      ]
    },
    "MockInterview": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MockInterview",
      "type": "object",
      "description": "Represents a mock interview session and its results.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the MockInterview entity."
        },
        "userId": {
          "type": "string",
          "description": "Reference to User. (Relationship: User 1:N MockInterview)"
        },
        "interviewDate": {
          "type": "string",
          "description": "Date and time the interview was conducted.",
          "format": "date-time"
        },
        "feedback": {
          "type": "string",
          "description": "Feedback provided by the AI interviewer."
        },
        "score": {
          "type": "number",
          "description": "Overall score for the mock interview."
        },
        "transcript": {
          "type": "string",
          "description": "The full transcript of the interview."
        }
      },
      "required": [
        "id",
        "userId",
        "interviewDate",
        "feedback",
        "score",
        "transcript"
      ]
    }
  },
  "auth": {
    "providers": [
      "password",
      "anonymous"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "User",
          "schema": {
            "$ref": "#/backend/entities/User"
          },
          "description": "Stores user profiles. Each document represents a user. All user-owned data is located under this path.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/linkedInPosts/{linkedInPostId}",
        "definition": {
          "entityName": "LinkedInPost",
          "schema": {
            "$ref": "#/backend/entities/LinkedInPost"
          },
          "description": "Stores LinkedIn posts generated by the user. Path-based ownership: Only the user with userId can access posts under their userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "linkedInPostId",
              "description": "The unique identifier of the LinkedIn post."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resumeAnalyses/{resumeAnalysisId}",
        "definition": {
          "entityName": "ResumeAnalysis",
          "schema": {
            "$ref": "#/backend/entities/ResumeAnalysis"
          },
          "description": "Stores resume analysis results for the user. Path-based ownership: Only the user with userId can access analyses under their userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "resumeAnalysisId",
              "description": "The unique identifier of the resume analysis."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/skillGaps/{skillGapId}",
        "definition": {
          "entityName": "SkillGap",
          "schema": {
            "$ref": "#/backend/entities/SkillGap"
          },
          "description": "Stores skill gap analyses and learning roadmaps for the user. Path-based ownership: Only the user with userId can access skill gaps under their userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "skillGapId",
              "description": "The unique identifier of the skill gap analysis."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/mockInterviews/{mockInterviewId}",
        "definition": {
          "entityName": "MockInterview",
          "schema": {
            "$ref": "#/backend/entities/MockInterview"
          },
          "description": "Stores mock interview sessions and results for the user. Path-based ownership: Only the user with userId can access mock interviews under their userId.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier of the user."
            },
            {
              "name": "mockInterviewId",
              "description": "The unique identifier of the mock interview."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure security, scalability, and ease of debugging, following the principles of Authorization Independence, Clarity of Intent, DBAC, and QAPs. It leverages Structural Segregation and Access Modeling to create a robust and maintainable system.\n\n**Authorization Independence:**  The design avoids hierarchical authorization dependencies by using path-based ownership and denormalization. All user-related data (LinkedInPosts, ResumeAnalysis, SkillGaps, MockInterviews) is stored under the `/users/{userId}` path, eliminating the need for `get()` calls in security rules to check parent document properties. This approach enables atomic operations (transactions/batches) and simplifies security rule logic.  Since all entities are owned by the user, no membership maps are needed. All data access is based on `request.auth.uid == userId`.\n\n**Structural Segregation:**  Each collection stores only documents with the same security requirements.  All data stored under `/users/{userId}` is private to the user identified by `userId`. This segregation drastically simplifies security rules.\n\n**Access Modeling:**  The structure uses path-based ownership for user-owned data. Each entity associated with a user (LinkedInPost, ResumeAnalysis, SkillGap, MockInterview) is stored as a subcollection under the `/users/{userId}` path.  This structure makes the intent very explicit:  only the user with the matching `uid` can access data under their respective `/users/{userId}` path. There is no need for `get()` calls in security rules because all data belongs to the user.\n\n**QAPs (Rules are not Filters):**  The structure supports secure `list` operations. Because all documents in a collection share the same security requirements (all data under `/users/{userId}` belongs to that user), listing data is secure and efficient. Rules do not act as filters, as only the authenticated user can access their data.\n\n**Data Clarity and Predictability:** The schema explicitly defines the structure of each document, using semantic naming and consistent data types. This approach enhances debuggability and maintainability."
  }
}