{
  "entities": {
    "UserProfile": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "UserProfile",
      "type": "object",
      "description": "Represents a user profile within the CareerFlow.ai application.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the user profile."
        },
        "email": {
          "type": "string",
          "description": "User's email address.",
          "format": "email"
        },
        "name": {
          "type": "string",
          "description": "User's full name."
        }
      },
      "required": [
        "id",
        "email",
        "name"
      ]
    },
    "LinkedInPost": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "LinkedInPost",
      "type": "object",
      "description": "Represents a generated LinkedIn post.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the LinkedIn post."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N LinkedInPost)"
        },
        "content": {
          "type": "string",
          "description": "The text content of the LinkedIn post."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time when the post was generated.",
          "format": "date-time"
        },
        "tone": {
          "type": "string",
          "description": "The tone of the LinkedIn post (e.g., professional, casual, hype)."
        },
        "projectDetails": {
          "type": "string",
          "description": "Project Details of the LinkedIn post."
        }
      },
      "required": [
        "id",
        "userId",
        "content",
        "creationDate",
        "tone",
        "projectDetails"
      ]
    },
    "ResumeAnalysis": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "ResumeAnalysis",
      "type": "object",
      "description": "Represents the analysis of a resume against a job description.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the resume analysis."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N ResumeAnalysis)"
        },
        "resumeText": {
          "type": "string",
          "description": "The Resume Text after converting file to text"
        },
        "jobDescription": {
          "type": "string",
          "description": "The job description used for the analysis."
        },
        "studentProjectPortfolioScore": {
          "type": "number",
          "description": "Score based on student project portfolio vs job description tech stack."
        },
        "technicalKnowledgeScore": {
          "type": "number",
          "description": "Score representing the technical knowledge match."
        },
        "keywordMatchScore": {
          "type": "number",
          "description": "Score based on keyword matches and context."
        },
        "analysisDate": {
          "type": "string",
          "description": "Date and time when the analysis was performed.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "jobDescription",
        "studentProjectPortfolioScore",
        "technicalKnowledgeScore",
        "keywordMatchScore",
        "analysisDate",
        "resumeText"
      ]
    },
    "SkillGapRoadmap": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "SkillGapRoadmap",
      "type": "object",
      "description": "Represents a 30-day learning roadmap tailored to a specific role.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the skill gap roadmap."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N SkillGapRoadmap)"
        },
        "targetRole": {
          "type": "string",
          "description": "The target role for the roadmap (e.g., AI Engineer, Frontend Dev)."
        },
        "jobDescription": {
          "type": "string",
          "description": "The job description used to create the roadmap."
        },
        "roadmap": {
          "type": "string",
          "description": "The roadmap data containing topics, resources, and GitHub links (likely JSON or markdown)."
        },
        "creationDate": {
          "type": "string",
          "description": "Date and time when the roadmap was generated.",
          "format": "date-time"
        }
      },
      "required": [
        "id",
        "userId",
        "targetRole",
        "jobDescription",
        "roadmap",
        "creationDate"
      ]
    },
    "MockInterview": {
      "$schema": "http://json-schema.org/draft-07/schema#",
      "title": "MockInterview",
      "type": "object",
      "description": "Represents a mock interview session.",
      "properties": {
        "id": {
          "type": "string",
          "description": "Unique identifier for the mock interview."
        },
        "userId": {
          "type": "string",
          "description": "Reference to UserProfile. (Relationship: UserProfile 1:N MockInterview)"
        },
        "interviewDate": {
          "type": "string",
          "description": "Date and time when the interview was conducted.",
          "format": "date-time"
        },
        "score": {
          "type": "number",
          "description": "Overall score received during the mock interview."
        },
        "feedback": {
          "type": "string",
          "description": "Detailed feedback provided by the AI interviewer."
        },
        "transcript": {
          "type": "string",
          "description": "Full transcript of the interview session."
        }
      },
      "required": [
        "id",
        "userId",
        "interviewDate",
        "score",
        "feedback",
        "transcript"
      ]
    }
  },
  "auth": {
    "providers": [
      "password"
    ]
  },
  "firestore": {
    "structure": [
      {
        "path": "/users/{userId}",
        "definition": {
          "entityName": "UserProfile",
          "schema": {
            "$ref": "#/backend/entities/UserProfile"
          },
          "description": "Stores user profile information.  Path-based ownership.  Authorization is based on matching `request.auth.uid` to `{userId}`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            }
          ]
        }
      },
      {
        "path": "/posts/{userId}/linkedin_posts/{linkedInPostId}",
        "definition": {
          "entityName": "LinkedInPost",
          "schema": {
            "$ref": "#/backend/entities/LinkedInPost"
          },
          "description": "Stores LinkedIn posts generated by the user. Path-based ownership. Authorization is based on matching `request.auth.uid` to `{userId}`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "linkedInPostId",
              "description": "The unique identifier for the LinkedIn post."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/resume_analyses/{resumeAnalysisId}",
        "definition": {
          "entityName": "ResumeAnalysis",
          "schema": {
            "$ref": "#/backend/entities/ResumeAnalysis"
          },
          "description": "Stores resume analysis results for the user. Path-based ownership. Authorization is based on matching `request.auth.uid` to `{userId}`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "resumeAnalysisId",
              "description": "The unique identifier for the resume analysis."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/skill_gap_roadmaps/{skillGapRoadmapId}",
        "definition": {
          "entityName": "SkillGapRoadmap",
          "schema": {
            "$ref": "#/backend/entities/SkillGapRoadmap"
          },
          "description": "Stores skill gap roadmaps generated for the user. Path-based ownership. Authorization is based on matching `request.auth.uid` to `{userId}`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "skillGapRoadmapId",
              "description": "The unique identifier for the skill gap roadmap."
            }
          ]
        }
      },
      {
        "path": "/users/{userId}/mock_interviews/{mockInterviewId}",
        "definition": {
          "entityName": "MockInterview",
          "schema": {
            "$ref": "#/backend/entities/MockInterview"
          },
          "description": "Stores mock interview data for the user. Path-based ownership. Authorization is based on matching `request.auth.uid` to `{userId}`.",
          "params": [
            {
              "name": "userId",
              "description": "The unique identifier for the user."
            },
            {
              "name": "mockInterviewId",
              "description": "The unique identifier for the mock interview."
            }
          ]
        }
      }
    ],
    "reasoning": "The Firestore data structure is designed to ensure security, scalability, and debuggability, adhering to the principles of Authorization Independence and Structural Segregation. User-owned data is stored under `/users/{userId}` for simple path-based ownership. All collections under a user's path inherit the user's authorization context, enabling easy security rule creation.\n\nThe `UserProfile` is stored directly at `/users/{userId}`.\n\nLinkedIn posts, Resume analyses, Skill Gap Roadmaps, and Mock Interviews are stored as subcollections of the user's document (`/users/{userId}/linkedin_posts`, `/users/{userId}/resume_analyses`, `/users/{userId}/skill_gap_roadmaps`, `/users/{userId}/mock_interviews`). This enforces a 1:N relationship and ownership, simplifying security rules.\n\nThis structure achieves Authorization Independence by avoiding the need for `get()` calls to parent documents for authorization. Security rules can directly check `request.auth.uid` against the `{userId}` parameter in the path.  It supports the QAP (Rules Are Not Filters) principle because listing operations are naturally scoped to the authenticated user's data.\n\nThis structure does not use custom claims for DBAC.  All authorization is based on the `request.auth.uid` and the document paths."
  }
}